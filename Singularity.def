Bootstrap: library
From: ubuntu:22.04

%post
	
	apt-get update
	apt-get --assume-yes install cmake
	apt update && apt upgrade -y
	apt install mpich -y
	apt install libopenmpi3 -y

%files
    	* /project/

%environment

# Executed at build time
%startscript
	cd /project/
	mkdir build/
	cd build/
	cmake ..
	make

# Executed when running the container
%runscript
	cd /project/build/
	exec mpirun -n 2 ./main
